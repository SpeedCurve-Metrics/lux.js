!function(){"use strict";var e={EvaluationStart:1,EvaluationEnd:2,InitCalled:3,MarkCalled:4,MeasureCalled:5,AddDataCalled:6,SendCalled:7,ForceSampleCalled:8,DataCollectionStart:9,UnloadHandlerTriggered:10,OnloadHandlerTriggered:11,MarkLoadTimeCalled:12,SendCancelledPageHidden:13,SessionIsSampled:21,SessionIsNotSampled:22,MainBeaconSent:23,UserTimingBeaconSent:24,InteractionBeaconSent:25,CustomDataBeaconSent:26,NavigationStart:41,PerformanceEntryReceived:42,PerformanceEntryProcessed:43,PerformanceObserverError:51,InputEventPermissionError:52,InnerHtmlAccessError:53,EventTargetAccessError:54,CookieReadError:55,CookieSetError:56,PageLabelEvaluationError:57,NavTimingNotSupported:71,PaintTimingNotSupported:72};function n(e){return e.map((function(e){return JSON.stringify(e)})).join(", ")}var t=document.querySelector("#input"),a=document.querySelector("#event-counter"),r=document.querySelector("#output"),o=document.querySelector("#parse"),i=document.querySelectorAll(".event-filter");if(!t||!r||!o)throw new Error("Cannot start debug parser.");function c(r){r.innerHTML="";var o=[];try{o=JSON.parse(t.value)}catch(e){r.appendChild(s("Could not parse input: ".concat(e),"red"))}a.innerText="(".concat(o.length," events)");for(var c=Number(new Date(o[0][0])),l=0,d=o;l<d.length;l++){var u=d[l];if(u[1]===e.NavigationStart){c=u[2][0];break}}var m=function(e){var n=[];return e.forEach((function(e){var t=e.getAttribute("data-event");e.checked&&t&&n.push(t)})),n}(i);o.forEach((function(t){var a=Number(new Date(t[0]))-c,o=function(t,a){var r=Object.keys(e).find((function(n){return e[n]===t[1]})),o=t[2],i=r||"Unknown Event";switch(o.length&&(i+=" (".concat(n(o),")")),t[1]){case e.EvaluationStart:return"lux.js v".concat(o[0]," is initialising.");case e.EvaluationEnd:return"lux.js has finished initialising.";case e.InitCalled:return"LUX.init()";case e.MarkLoadTimeCalled:return"LUX.markLoadTime(".concat(n(o),")");case e.MarkCalled:return a.includes("userTiming")?"LUX.mark(".concat(n(o),")"):"";case e.MeasureCalled:return a.includes("userTiming")?"LUX.measure(".concat(n(o),")"):"";case e.AddDataCalled:return a.includes("addData")?"LUX.addData(".concat(n(o),")"):"";case e.SendCalled:return"LUX.send()";case e.SendCancelledPageHidden:return"This beacon was not sent because the page visibility was hidden.";case e.ForceSampleCalled:return"LUX.forceSample()";case e.DataCollectionStart:return"Preparing to send main beacon. Any metrics received after this point may be ignored.";case e.UnloadHandlerTriggered:return"Unload handler was triggered.";case e.OnloadHandlerTriggered:return i="Onload handler was triggered after ".concat(o[0]," ms."),o[1]>0&&(i+="Minimum measure time was ".concat(o[1])),i;case e.SessionIsSampled:return"Sample rate is ".concat(o[0],"%. This session is being sampled.");case e.SessionIsNotSampled:return"Sample rate is ".concat(o[0],"%. This session is not being sampled.");case e.MainBeaconSent:return i="Main beacon sent",a.includes("beaconUrl")&&(i+=": ".concat(o[0])),i;case e.UserTimingBeaconSent:return i="Supplementary user timing beacon sent",a.includes("beaconUrl")&&(i+=": ".concat(o[0])),i;case e.InteractionBeaconSent:return i="Supplementary user interaction beacon sent",a.includes("beaconUrl")&&(i+=": ".concat(o[0])),i;case e.CustomDataBeaconSent:return i="Supplementary custom data beacon sent",a.includes("beaconUrl")&&(i+=": ".concat(o[0])),i;case e.NavigationStart:return"";case e.PerformanceEntryReceived:return"layout-shift"===o[0].entryType?"Received layout shift at ".concat(o[0].startTime.toFixed()," ms with value of ").concat(o[0].value.toFixed(3)):"longtask"===o[0].entryType?"Received long task with duration of ".concat(o[0].duration," ms"):"largest-contentful-paint"===o[0].entryType?"Received LCP entry at ".concat(o[0].startTime.toFixed()," ms"):"element"===o[0].entryType?"Received element timing entry for ".concat(o[0].identifier," at ").concat(o[0].startTime.toFixed()," ms"):(i="Received ".concat(o[0].entryType," entry"),o[0].startTime&&(i+=" at ".concat(o[0].startTime.toFixed()," ms")),i);case e.PerformanceEntryProcessed:return"largest-contentful-paint"===o[0].entryType?"Picked LCP from entry at ".concat(o[0].startTime.toFixed()," ms"):"";case e.PerformanceObserverError:return"Error while initialising PerformanceObserver: ".concat(o[0]);case e.InputEventPermissionError:return"Error reading input event. Cannot calculate FID for this page.";case e.InnerHtmlAccessError:return"Cannot read the innerHTML property of an element. Cannot calculate inline style or script sizes for this page.";case e.EventTargetAccessError:return"Error reading input event. Cannot calculate user interaction times for this page.";case e.CookieReadError:return"Error reading session cookie. This page will not be linked to a user session.";case e.CookieSetError:return"Error setting session cookie. This page will not be linked to a user session.";case e.PageLabelEvaluationError:return"Error while evaluating '".concat(o[0],"' for the page label: ").concat(o[1]);case e.NavTimingNotSupported:return"The Navigation Timing API is not supported. Performance metrics for this page will be limited.";case e.PaintTimingNotSupported:return"Start render time could not be determined."}return i}(t,m);if(o)if(function(n){return[e.MainBeaconSent,e.CustomDataBeaconSent,e.InteractionBeaconSent,e.UserTimingBeaconSent].includes(n)}(t[1])){var i=s("".concat((new Intl.NumberFormat).format(a)," ms: ").concat(o));i.classList.add("tooltip-container");var l=new URL(t[2][0]),d=document.createElement("span");d.className="tooltip",d.innerHTML="\n          <b>Page label:</b> ".concat(l.searchParams.get("l"),"<br>\n          <b>Hostname:</b> ").concat(l.searchParams.get("HN"),"<br>\n          <b>Path:</b> ").concat(l.searchParams.get("PN"),"<br>\n          <b>lux.js version:</b> ").concat(l.searchParams.get("v"),"<br>\n        "),i.appendChild(d),r.appendChild(i)}else r.appendChild(s("".concat((new Intl.NumberFormat).format(a)," ms: ").concat(o)))}));var p=new Date(c);r.prepend(s("0 ms: Navigation started at ".concat(p.toLocaleDateString()," ").concat(p.toLocaleTimeString())))}function s(e,n){var t=document.createElement("li");return t.textContent=e,t.className=n||"",t}o.addEventListener("click",(function(){return c(r)})),i.forEach((function(e){e.addEventListener("change",(function(){return c(r)}))}))}();
