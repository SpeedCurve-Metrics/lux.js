<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LUX prerender test page</title>
    <script>/*INJECT_SCRIPT*/</script>
    <script src="/js/lux.js?id=10001" async crossorigin="anonymous"></script>
</head>
<body>
    <h1>LUX prerender test page</h1>
    <p>This page can be prerendered from <a href="/prerender-index.html">the prerender test index page</a>.</p>
    <ul id="log"></ul>

    <script>
    const events = [
        "visibilitychange",
        "pageshow",
        "load",
        "DOMContentLoaded",
    ];

    log(`[${performance.now().toFixed(0)} ms] Visibility state ${document.visibilityState}`);
    log(`[${performance.now().toFixed(0)} ms] Prerendering ${document.prerendering}`);

    events.forEach((eventName) => {
        addEventListener(eventName, () => {
            let extras = "";

            if (eventName === "visibilitychange") {
                extras = document.visibilityState;
                extras = `${document.prerendering}`;
            }

            log(`[${performance.now().toFixed(0)} ms] ${eventName} ${extras}`);
        });
    });

    document.addEventListener("prerenderingchange", () => {
        log(`[${performance.now().toFixed(0)} ms] Prerendering ${document.prerendering}`);
    });

    function log(message) {
        const li = document.createElement("li");
        li.textContent = message;
        document.getElementById("log").appendChild(li);
    }
    </script>
</body>
</html>
